

# NOIPupil模拟赛



### by:dogcdt



| 题目名称 |     常数国     |    电竞选手    |   世界线修理   |
| :------- | :------------: | :------------: | :------------: |
| 源码名称 |     in.cpp     |    out.cpp     |    cpp.cpp     |
| 时间限制 |     6000ms     |     1000ms     |     1000ms     |
| 内存限制 |     666MB      |     666MB      |     666MB      |
| 题目类型 |      传统      |      传统      |      传统      |
| 编译选项 | -O2 -std=C++11 | -O2 -std=C++11 | -O2 -std=C++11 |






#### 注意：

1. 时限可能会根据评测机当天情况有所更改
2. 如发现原题请勿声张 ~~闷声发大财总是好的~~
3. AK选手可以在考场表明包括但不限于“题目好水啊”，“出题人好菜啊”，“我10分钟不到就AK了”此类
4. 考试时间为**3.5小时**
5. 题目难度与顺序无关，与出题人心情有关
6. T1与T3采取**捆绑测试**
7. 题面中提及的`[数据删除]`与现实的`[数据删除]`大部分无关
8. 大家如果想题的思路有些阻塞，可以听一下我给大家发的`mp3`文件供大家放松















---

####  1  常数国
##### 1.1  Description
> Yo\*Ma\*Y*ng其实是`[数据删除]`的成员，作为$\blacksquare \blacksquare $-$9$，为了实现娱乐至上的宗旨，他可以通过修改世界参数的方式增加游戏乐趣。比如说他现在虽然在进行n周目的OI线体验，但他以前是其实当过某\*\*\*\*世界的国王。

对面神灵种代表Hack国国王ZJB因与机凯种代表XSC联手，向人类种代表常数国国王YMY发起挑战，为此YMY赌上了人类种的命运和他最重要的~~妹妹~~爸爸DYX。由于YMY自己对世界线的规则要求，两国之间只能通过游戏决定胜负，而游戏的内容是一个复杂的卡牌游戏。你是布置游戏场景的一员，时间加紧，你需要一份程序来实现游戏中的一部分抽卡过程。

现在你有$n$张卡牌，现在**这$n$张卡牌排成一个圈**，所以第$n$张卡牌的下一张是第$1$张。每张牌的初始权值为$a_i$。你将进行$q$个操作，每个操作会指定**圈上的一段顺时针从$l_i$到$r_i$的弧**，并给你一张权值为$v_i$的手牌。然后**顺时针遍历**这段弧上的牌，一旦遍历到的那张牌**权值大于手里的牌**，将手里的牌与这张牌进行**交换**。需要求出遍历完后手里那张牌的权值，之后将这张牌丢弃。

其实相当于实现这样一段代码：
```cpp
if (l<=r)
	for (int i=l;i<=r;++i) if (a[i]>v)
		swap(a[i],v);
else 
{
	for (int i=l;i<=n;++i) if (a[i]>v)
		swap(a[i],v);
	for (int i=1;i<=r;++i) if (a[i]>v)
		swap(a[i].v);
}
return v;
```



##### 1.2  Input Format

第一行，两个数字$n,q$，分别表示卡牌个数和操作个数；

接下来$n$行，每行一个整数，第$i$个为$a_i$；

接下来$q$行，每行三个整数$l_i,r_i,v_i$

##### 1.3  Output Format

输出$q$行，每行一个数，为交换完后的$v_i$

##### 1.4  Sample

**Input 1:**

```
4 2
5
2
4
7
1 4 3
1 4 1
```

**Output 1:**

```
7
5
```



**Input 2:**

```
10 10
19
5
8
17
14
3
9
10
7
6
1 8 4
7 3 2
5 9 10
4 8 3
10 3 6
8 7 4
6 6 3
2 9 12
6 3 7
9 6 3
```

**Output 2:**

```
19
10
14
17
8
10
3
12
7
9
```

**对样例2的解释：**

> 刚开始时，$a$数组形如$\{19,5,8,17,14,3,9,10,7,6\}$
>
> 一回合后：$\{4,5,8,17,14,3,9,10,7,6\}$
>
> 两回合后：$\{4,5,8,17,14,3,2,9,7,6\}$
>
> 三回合后：$\{4,5,8,17,10,3,2,9,7,6\}$
>
> $……$



##### 1.5  Constraints

对于$25\%$的数据，$1≤n ≤2000,1\le q\le 2000$；

对于另外$15\%$的数据，$l=1,r=n$；

对于$100\%$的数据，$1\le n\le 4×10^5,1\le q\le 25000,1\le a_i\le 10^9,1\le l,r\le n,1\le v_i\le 10^9$

##### 1.6 After Story

游戏将近结束时期，常数国国王马上就要迎来胜利曙光。这时，~~root~~沙皇带着他的时间沙漏扫六合，统一了X503六种族，4号世界线完结。

































---

####   2  电竞选手
##### 2.1  Description
> FKB其实是`[数据删除]`的成员，作为$\blacksquare \blacksquare $-$7$，为了实现娱乐至上的宗旨，他可以通过修改世界参数的方式增加游戏乐趣。比如说他现在虽然在进行n周目的OI线体验，但他以前其实化名Faker带领电竞界走上巅峰。

Faker走上电竞界巅峰的时刻，曾有记者采访过他，在你奋斗时期的动力是什么。为此，Faker发表长篇访谈`奋斗的人生最美丽`，其中花了将近三天的时间从他的~~网恋男友~~前辈YYB对他以前的支持到YYB前辈最近又在之前的世界线发表博客虽然博客内容是对SW的憧憬但他还是要去评论了，才结束了这次访谈。

访谈中，Faker提到YYB给他安利过的一款消除隔膜。隔膜内容是这样的：

你有$n$个方块排成一排，每个方块有一个权值$a_i$，你每次可以选择一个二元组$(x,y) x<y$，并**消除$x$和$y$中权值较小的那个方块**，如果二者**权值相同则消除标号较小**的那个，产生**$max(a_x,a_y)$**的费用。你每次选择的二元组中**不能选择已经被消除的方块**。最后这一排方块只会剩下一个，游戏目标是使**费用最少**。

以Faker的手速和判断速度这显然是件很简单的事，你要求的是**使最后费用最少的二元组操作方案数**，方案数**对**$10^9+7$**取模**。

**ps**：对于$\{3,6,8,9\}$虽然选$(1,2)$或选$(1,3)$都会使$1$位置的方块消除，但是是两种不同的方案。

#####  2.2  Input Format

第一行一个整数$n$

第二行$n$个整数$a_1,a_2,a_3,...,a_n(1≤a_i≤10^9)$

##### 2.3  Output Format  

输出一个数字，为**使最后费用最少的操作方案数**

##### 2.4  Sample

**Input 1:**

```
4
1 4 2 3
```

**Output 1:**

```
1
```

**样例解释：**

>按顺序选择二元组$(1,3)\ (3,4)\ (2,4)$



**Input 2:**

```
6
3 1 8 1 5 8
```

**Output 2:**

```
6
```



##### 2.5  Constraints

对于$10\%$的数据，$n\le 5$；

对于$30\%$的数据，$n\le2000,1\le a_i\le 10$；

对于另外$20\%$的数据，$a_i$均相同；

对于$100\%$的数据，$n\le 10^5,1\le a_i\le 10^9$

##### 2.6 After Story

Faker面临最后之战时，他的电脑SW突然出现了问题，发现原因是三号被**root**叫去修世界线了，这导致对面一位名为H***01的选手取得了最后之战的胜利，17号世界线完结。







































---

#### 3  世界线修理
##### 3.1  Description

> SWSCLt其实是`[数据删除]`的成员，作为$\blacksquare \blacksquare $-$3$，为了实现娱乐至上的宗旨，他可以通过修改世界参数的方式增加游戏乐趣。比如说他现在虽然在进行n周目的OI线体验，并且昨天还给大家考了一套毒瘤题，但其实在考试期间，他在帮**root** 修理$\blacksquare \blacksquare $-$7$和$\blacksquare \blacksquare $-$9$乱玩世界线而产生的锅。

世界线其实是一个**树形结构(有根树)**，你可以从初始节点出发，走入不同的分支结局。$\blacksquare \blacksquare $-$3$需要给树上的每个节点改变可玩性，也就是**给每个点赋权值(可以为负数，权值的绝对值$\le n$)**。这棵世界线被**root**认可当且仅当**每棵子树的权值和的绝对值为1**。

这本来是个很简单的任务，但是$\blacksquare \blacksquare $-$3$得知这棵树过段时间就会被$\blacksquare \blacksquare $-$7$和$\blacksquare \blacksquare $-$9$重构了，他并不想再修一次世界线了。$\blacksquare \blacksquare $-$3$得知了他们下一次重构的树的形状，他就采取了一种神奇的赋值方案，**这个赋值方案对两棵树都有效**。

修锅修到一半，$\blacksquare \blacksquare $-$3$被拉去发起仿生人革命，所以这个问题要靠你来解决了。


##### 3.2  Input Format

第一行一个整数$n$为树的节点个数

第二行$n$个整数$f_i$，表示第一棵树里第$i$个节点的父亲，$f_i$如果为 -1 则表示$i$为第一棵树的根节点

第三行$n$个整数$g_i$，表示第二棵树里第$i$个节点的父亲，$g_i$如果为 -1 则表示$i$为第二棵树的根节点

##### 3.3  Output Format

如果不存在赋值方案，第一行输出"IMPOSSIBLE"

否则第一行输出"POSSIBLE"，并在第二行输出**任何一种赋值方案**

如果答案第一行正确但在需要输出方案时未输出方案，将得到每个点$30\%$的部分分

##### 3.4  Sample

**Input 1:**

```
5
3 3 4 -1 4
4 4 1 -1 1
```

**Output 1:**

```
POSSIBLE
1 -1 -1 3 -1
```



**Input 2:**

```
6
-1 5 1 5 1 3
6 5 5 3 -1 3
```

**Output 2:**

```
IMPOSSIBLE
```



**Input 3:**

````
8
2 7 1 2 2 1 -1 4
4 -1 4 7 4 4 2 4
````

**Output 3:**

```
POSSIBLE
1 2 -1 0 -1 1 0 -1
```



**In&&Output 2:**

见下发文件

##### 3.5  Constraints

对于$10\%$的数据，$\forall i,f_i=g_i$

对于另外$10\%$的数据，树为一条链(ps:root不一定只有一个儿子)

对于$100\%$的数据，$n\le 10^5$

##### 3.6 After Story

```
[记录开始]
▇▇-3: 所以呢，世界线又被他们重构了
root: 这次又要拜托你了
▇▇-3: (停顿)[数据删除]
root: 明明你一副乐在其中的样子呢
▇▇-3: (笑)那这次又是什么原因呢
root: 他们在当前时间线触发了茶叶青蛙的收容物件
▇▇-3: (一脸疑惑并瞪着对方)
root: 好了，快开工吧
[记录结束]
```




